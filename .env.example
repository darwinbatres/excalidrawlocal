# =============================================================================
# Enterprise Excalidraw - Environment Configuration
# =============================================================================
#
# ⚠️  STOP! You probably want the official Excalidraw instead.
# → https://excalidraw.com (free, real-time collab, E2EE, no setup)
#
# This self-hosted version is ONLY for specific enterprise needs:
# - Multi-tenant workspaces with RBAC
# - Persistent version history
# - Audit logging for compliance
# - Full data sovereignty (PostgreSQL)
#
# If you don't need these, use excalidraw.com instead.
#
# =============================================================================
# QUICK START (Docker)
# =============================================================================
#   1. cp .env.example .env
#   2. Generate AUTH_SECRET: openssl rand -base64 32
#   3. Change POSTGRES_PASSWORD to something strong
#   4. docker compose up -d --build
#   5. Open http://localhost:3021
#
# =============================================================================
# PRODUCTION CHECKLIST
# =============================================================================
#   □ AUTH_SECRET is randomly generated (32+ chars)
#   □ POSTGRES_PASSWORD is strong and unique
#   □ DEMO_USER_* variables are REMOVED (not just commented)
#   □ NEXTAUTH_URL matches your public domain
#   □ NEXT_PUBLIC_APP_URL matches your public domain
#   □ HTTPS is enabled via reverse proxy or Cloudflare Tunnel
# =============================================================================

# -----------------------------------------------------------------------------
# Environment
# -----------------------------------------------------------------------------
NODE_ENV=production

# -----------------------------------------------------------------------------
# Database (PostgreSQL 16)
# -----------------------------------------------------------------------------
# ⚠️  SECURITY: Change this password before deploying!
# Use a strong, randomly generated password (32+ characters recommended)
# Generate with: openssl rand -base64 32
POSTGRES_USER=excalidraw
POSTGRES_PASSWORD=CHANGE_ME_USE_STRONG_PASSWORD
POSTGRES_DB=excalidraw

# Database connection string
# For Docker: use "postgres" as hostname (container name)
# For local dev without Docker: change "postgres" to "localhost"
DATABASE_URL=postgresql://${POSTGRES_USER}:${POSTGRES_PASSWORD}@postgres:5432/${POSTGRES_DB}?schema=public

# NOTE: docker-compose.yml exposes PostgreSQL on 127.0.0.1:5432 for local dev
# tools (Prisma Studio, etc.). For production, consider removing this port
# binding entirely by editing docker-compose.yml.

# -----------------------------------------------------------------------------
# Authentication (NextAuth v4)
# -----------------------------------------------------------------------------
# ⚠️  SECURITY: This MUST be changed for production!
# Generate a secure secret: openssl rand -base64 32
AUTH_SECRET=CHANGE_ME_RUN_openssl_rand_base64_32

# Trust the host header (required for Docker/reverse proxy/Cloudflare Tunnel)
# Keep this as "true" unless you know what you're doing
AUTH_TRUST_HOST=true

# ⚠️  IMPORTANT: Set this to your actual public URL
# This is used for OAuth callbacks and session cookies
# Examples:
#   - Local dev (pnpm dev): http://localhost:3021
#   - Docker: http://localhost:3021
#   - Cloudflare Tunnel: https://excalidraw.yourdomain.com
#   - Custom domain: https://whiteboard.company.com
NEXTAUTH_URL=http://localhost:3021

# -----------------------------------------------------------------------------
# OAuth Providers (Optional)
# -----------------------------------------------------------------------------
# Uncomment and configure to enable OAuth login alongside email/password
#
# Google OAuth - Create credentials at: https://console.cloud.google.com/apis/credentials
# GOOGLE_CLIENT_ID=your-google-client-id.apps.googleusercontent.com
# GOOGLE_CLIENT_SECRET=your-google-client-secret
#
# GitHub OAuth - Create OAuth App at: https://github.com/settings/developers
# GITHUB_ID=your-github-client-id
# GITHUB_SECRET=your-github-client-secret

# -----------------------------------------------------------------------------
# Application Settings
# -----------------------------------------------------------------------------
# ⚠️  IMPORTANT: Set this to your actual public URL (same as NEXTAUTH_URL)
# Used for CORS headers, generating links, and client-side redirects
NEXT_PUBLIC_APP_URL=http://localhost:3021

# Autosave interval in milliseconds
# Default: 10000 (10 seconds) - saves only when content actually changes
# Minimum recommended: 5000 (5 seconds)
# Set higher for slower connections or to reduce server load
NEXT_PUBLIC_AUTOSAVE_INTERVAL_MS=10000

# -----------------------------------------------------------------------------
# Storage Limits
# -----------------------------------------------------------------------------
# Storage limits are configured in src/lib/constants.ts (not via env vars).
# This provides type safety and allows limits to scale with content type.
#
# Default limits:
#   - Markdown cards: 1,000 KB per card
#   - Rich text cards: 2,000 KB per card (Tiptap JSON is more verbose)
#   - Images: 50 MB per image
#   - Total board size: 500 MB
#   - Max elements per board: 10,000
#   - Max versions per board: 100
#
# Card editors show real-time size indicators with warnings at 80% capacity.
# Users cannot save content that exceeds the configured limits.

# -----------------------------------------------------------------------------
# Rate Limiting
# -----------------------------------------------------------------------------
# API requests per minute per IP address
# Login attempts have a stricter limit of 10/min (hardcoded for brute-force protection)
# Increase for power users, decrease if you see abuse
RATE_LIMIT_REQUESTS_PER_MINUTE=60

# -----------------------------------------------------------------------------
# Cloudflare Tunnel (Optional - secure remote access without port forwarding)
# -----------------------------------------------------------------------------
# Cloudflare Tunnel lets you expose your app to the internet securely,
# without opening firewall ports. It's the recommended way for production.
#
# Quick Setup:
#   1. Create tunnel: https://one.dash.cloudflare.com → Networks → Tunnels
#   2. Name it (e.g., "excalidraw"), copy the token (starts with "eyJ...")
#   3. Add public hostname in Cloudflare:
#        Subdomain: excalidraw | Domain: yourdomain.com
#        Service Type: HTTP | URL: app:3021
#   4. Paste token below and update NEXTAUTH_URL + NEXT_PUBLIC_APP_URL above
#   5. Start: docker compose --profile tunnel up -d --build
#
# CLOUDFLARE_TUNNEL_TOKEN=

# -----------------------------------------------------------------------------
# Demo User (DEVELOPMENT/TESTING ONLY)
# -----------------------------------------------------------------------------
# ⚠️  SECURITY: Remove these lines entirely for production deployments!
# If set, creates a demo user on first startup for testing purposes.
# The seed script will skip demo user creation if these are not set.
#
# DEMO_USER_EMAIL=demo@example.com
# DEMO_USER_PASSWORD=demo123456
# DEMO_USER_NAME=Demo User
